<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">
<title>G√©n√©rateur SEEV.001</title>
<style>
body{font-family:Arial;padding:20px;background:#f0f0f0}
.container{max-width:1600px;margin:0 auto;background:white;padding:20px;border-radius:8px}
h1{color:#2a5298;text-align:center}
.paste{width:100%;min-height:100px;margin:10px 0;padding:10px;border:2px solid #667eea;border-radius:5px;box-sizing:border-box}
.btn{padding:10px 20px;margin:5px;border:none;border-radius:5px;cursor:pointer;font-weight:bold}
.btn-blue{background:#667eea;color:white}
.btn-green{background:#28a745;color:white}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:20px}
.form-section{padding:10px}
input,textarea{width:100%;padding:6px;margin:3px 0;border:1px solid #ddd;border-radius:3px;font-size:12px;box-sizing:border-box}
textarea{min-height:50px}
.xml-output{background:#2d2d2d;color:#a9dc76;padding:15px;border-radius:5px;font-family:monospace;font-size:10px;white-space:pre-wrap;min-height:400px;max-height:600px;overflow-y:auto}
.section{margin:15px 0;padding:10px;background:#f8f9fa;border-left:3px solid #667eea;border-radius:3px}
label{font-weight:bold;font-size:11px;display:block;margin-top:8px}
.dropzone{border:2px dashed #667eea;padding:30px;margin:10px 0;border-radius:5px;text-align:center;cursor:pointer;background:#f8f9ff}
.dropzone:hover{background:#e8edff}
.dropzone.dragover{background:#d0d8ff;border-color:#4a5bc7}
</style>
</head>
<body>
<div class="container">
<h1>üè¶ G√©n√©rateur Swift SEEV.001.001.12</h1>

<div style="background:#e8edff;padding:15px;border-radius:5px;margin:15px 0">
<strong>üìã √âTAPE 1 : Importez votre notice</strong><br>
<div class="dropzone" id="dropzone">
<div style="font-size:2em">üìÑ</div>
<div style="font-weight:bold;color:#2a5298">Glissez-d√©posez votre fichier ici</div>
<div style="font-size:0.9em;color:#666;margin-top:5px">ou cliquez pour s√©lectionner (.docx, .pdf, .txt)</div>
<input type="file" id="fileinput" accept=".docx,.pdf,.txt" style="display:none">
</div>
<strong>OU copiez-collez le texte :</strong>
<textarea id="paste" class="paste" placeholder="Collez le texte complet..."></textarea>
<button class="btn btn-blue" onclick="analyser()">üîç Analyser</button>
<button class="btn btn-green" onclick="location.reload()">üîÑ R√©initialiser</button>
</div>

<div id="msg" style="padding:10px;margin:10px 0;border-radius:5px"></div>

<div class="grid">
<div class="form-section">
<h3>üìù Formulaire</h3>

<div class="section">
<strong>Meeting IDs</strong>
<label>Meeting ID</label><input id="mid" value="GMET000000000">
<label>Issuer Meeting ID</label><input id="imid" value="GMET000000000">
</div>

<div class="section">
<strong>Dates</strong>
<label>Date Annonce</label><input type="datetime-local" id="ann">
<label>Date R√©union</label><input type="datetime-local" id="mtg">
<label>Record Date</label><input type="date" id="rec">
<label>Voting Deadline</label><input type="datetime-local" id="vote">
<label>Confirmation Deadline</label><input type="datetime-local" id="conf">
</div>

<div class="section">
<strong>√âmetteur & Titre</strong>
<label>Nom √âmetteur</label><input id="iss">
<label>ISIN</label><input id="isin">
<label>Holding Balance</label><input id="bal">
</div>

<div class="section">
<strong>Lieu R√©union</strong>
<label>Rue</label><input id="st">
<label>Num√©ro</label><input id="bn">
<label>Code Postal</label><input id="pc">
<label>Ville</label><input id="town" value="LUXEMBOURG">
<label>URL Documentation</label><input id="url">
</div>

<div class="section">
<strong>R√©solutions</strong>
<div id="resc"></div>
<button class="btn btn-green" onclick="addR()">‚ûï Ajouter</button>
</div>

</div>

<div>
<h3 style="color:#78dce8">üìÑ XML G√©n√©r√©</h3>
<button class="btn btn-green" onclick="copyXml()">üìã Copier</button>
<button class="btn btn-blue" onclick="dlXml()">üíæ T√©l√©charger</button>
<pre id="out" class="xml-output"></pre>
</div>
</div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

<script>
var R=[];
var C=0;

function init(){
console.log('=== INIT ===');

// Dates par d√©faut
var n=new Date();
document.getElementById('ann').value=n.toISOString().substring(0,16);
var d30=new Date(n.getTime()+30*24*60*60*1000);
document.getElementById('mtg').value=d30.toISOString().substring(0,16);
document.getElementById('vote').value=d30.toISOString().substring(0,16);
document.getElementById('conf').value=d30.toISOString().substring(0,16);
var d14=new Date(n.getTime()+14*24*60*60*1000);
document.getElementById('rec').value=d14.toISOString().substring(0,10);

// IDs
document.getElementById('mid').value='GMET'+Math.floor(Math.random()*1000000000);
document.getElementById('imid').value='GMET'+Math.floor(Math.random()*1000000000);

// Setup drag & drop
var dz=document.getElementById('dropzone');
var fi=document.getElementById('fileinput');

dz.onclick=function(e){
if(e.target!==fi){fi.click();}
};

fi.onchange=function(e){
if(e.target.files&&e.target.files[0]){
handleFile(e.target.files[0]);
}
};

dz.ondragenter=function(e){
e.preventDefault();
e.stopPropagation();
dz.classList.add('dragover');
};

dz.ondragover=function(e){
e.preventDefault();
e.stopPropagation();
dz.classList.add('dragover');
};

dz.ondragleave=function(e){
e.preventDefault();
e.stopPropagation();
dz.classList.remove('dragover');
};

dz.ondrop=function(e){
e.preventDefault();
e.stopPropagation();
dz.classList.remove('dragover');
console.log('DROP event',e.dataTransfer.files);
if(e.dataTransfer.files&&e.dataTransfer.files[0]){
handleFile(e.dataTransfer.files[0]);
}
};

// Prevent browser default
document.addEventListener('dragover',function(e){e.preventDefault();});
document.addEventListener('drop',function(e){e.preventDefault();});

// PDF.js worker
if(typeof pdfjsLib!=='undefined'){
pdfjsLib.GlobalWorkerOptions.workerSrc='https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
console.log('PDF.js ready');
}

// R√©solution par d√©faut
addR();

// G√©n√©rer XML
gen();

// Listeners
var els=document.querySelectorAll('input,textarea');
for(var i=0;i<els.length;i++){
els[i].addEventListener('input',gen);
els[i].addEventListener('change',gen);
}

console.log('=== INIT DONE ===');
}

function handleFile(file){
console.log('handleFile:',file.name,file.type,file.size);
var ext=file.name.split('.').pop().toLowerCase();
msg('‚è≥ Lecture: '+file.name);

if(ext==='docx'){
readDocx(file);
}else if(ext==='pdf'){
readPdf(file);
}else if(ext==='txt'){
readTxt(file);
}else{
msg('‚ùå Format non support√©: '+ext);
}
}

function readDocx(file){
var reader=new FileReader();
reader.onload=function(e){
if(typeof mammoth==='undefined'){
msg('‚ùå Mammoth.js non charg√©');
return;
}
mammoth.extractRawText({arrayBuffer:e.target.result})
.then(function(result){
console.log('DOCX extrait:',result.value.length,'chars');
document.getElementById('paste').value=result.value;
analyser();
})
.catch(function(err){
msg('‚ùå Erreur DOCX: '+err.message);
console.error(err);
});
};
reader.onerror=function(){msg('‚ùå Erreur lecture fichier');};
reader.readAsArrayBuffer(file);
}

function readPdf(file){
if(typeof pdfjsLib==='undefined'){
msg('‚ùå PDF.js non charg√©');
return;
}
var reader=new FileReader();
reader.onload=function(e){
var data=new Uint8Array(e.target.result);
pdfjsLib.getDocument({data:data}).promise.then(function(pdf){
console.log('PDF pages:',pdf.numPages);
var promises=[];
for(var i=1;i<=pdf.numPages;i++){
promises.push(getPageText(pdf,i));
}
Promise.all(promises).then(function(pages){
var text=pages.join('\n\n');
console.log('PDF extrait:',text.length,'chars');
document.getElementById('paste').value=text;
analyser();
});
}).catch(function(err){
msg('‚ùå Erreur PDF: '+err.message);
console.error(err);
});
};
reader.readAsArrayBuffer(file);
}

function getPageText(pdf,pageNum){
return pdf.getPage(pageNum).then(function(page){
return page.getTextContent().then(function(content){
return content.items.map(function(item){return item.str;}).join(' ');
});
});
}

function readTxt(file){
var reader=new FileReader();
reader.onload=function(e){
console.log('TXT extrait:',e.target.result.length,'chars');
document.getElementById('paste').value=e.target.result;
analyser();
};
reader.onerror=function(){msg('‚ùå Erreur lecture TXT');};
reader.readAsText(file);
}

function msg(t,ok){
var m=document.getElementById('msg');
m.innerHTML=t;
m.style.background=ok?'#d4edda':'#fff3cd';
m.style.color=ok?'#155724':'#856404';
m.style.border='1px solid '+(ok?'#28a745':'#ffc107');
setTimeout(function(){m.innerHTML='';},5000);
}

function analyser(){
var txt=document.getElementById('paste').value;
if(!txt||txt.length<50){msg('‚ùå Texte trop court');return;}

msg('üîç Analyse en cours...');
console.log('=== ANALYSE ===');
console.log('Texte:',txt.length,'chars');

var found=[];

// === ISIN (am√©lior√©) ===
var isinPatterns=[
/ISIN\s*[:\s]\s*([A-Z]{2}[A-Z0-9]{9}[0-9])/i,
/\b(LU[0-9]{10})\b/,
/\b(XS[0-9]{10})\b/,
/\b(FR[0-9]{10})\b/,
/\b(DE[0-9]{10})\b/,
/\b(BE[0-9]{10})\b/,
/(LU|XS)\s?[0-9]\s?[0-9]\s?[0-9]\s?[0-9]\s?[0-9]\s?[0-9]\s?[0-9]\s?[0-9]\s?[0-9]\s?[0-9]/i
];
var isinVal=null;
for(var i=0;i<isinPatterns.length&&!isinVal;i++){
var m=txt.match(isinPatterns[i]);
if(m){
isinVal=(m[1]||m[0]).replace(/\s/g,'').toUpperCase();
if(isinVal.length===12){
document.getElementById('isin').value=isinVal;
found.push('ISIN');
console.log('ISIN:',isinVal);
}
}
}

// === √âmetteur ===
var issMatch=txt.match(/\*\*([A-Z][A-Za-z\s]+(?:SE|SA|S\.A\.))\*\*/);
if(!issMatch)issMatch=txt.match(/^([A-Z][A-Za-z\s]+(?:SE|SA))\s*$/m);
if(!issMatch)issMatch=txt.match(/convened by ([A-Z][A-Za-z\s,\.]+(?:SE|SA|Ltd|GmbH))/i);
if(issMatch){
var issVal=issMatch[1].trim().toUpperCase();
document.getElementById('iss').value=issVal;
found.push('√âmetteur');
console.log('√âmetteur:',issVal);
}

// === Balance ===
var balMatch=txt.match(/\(([0-9,]+)\)\s*shares/i);
if(!balMatch)balMatch=txt.match(/([0-9,]+)\s*(?:shares|actions|obligations)/i);
if(balMatch){
var balVal=balMatch[1].replace(/,/g,'');
document.getElementById('bal').value=balVal;
found.push('Balance');
console.log('Balance:',balVal);
}

// === Dates ===
var MO=['january','february','march','april','may','june','july','august','september','october','november','december'];

// Meeting date
var mtgMatch=txt.match(/held on (\d{1,2})\s+(January|February|March|April|May|June|July|August|September|October|November|December)\s+(\d{4})\s+at\s+(\d{1,2}):(\d{2})/i);
if(mtgMatch){
var mo=(MO.indexOf(mtgMatch[2].toLowerCase())+1).toString().padStart(2,'0');
var dy=mtgMatch[1].padStart(2,'0');
var dtVal=mtgMatch[3]+'-'+mo+'-'+dy+'T'+mtgMatch[4].padStart(2,'0')+':'+mtgMatch[5];
document.getElementById('mtg').value=dtVal;
found.push('Date r√©union');
console.log('Date r√©union:',dtVal);
}

// Record date
var recMatch=txt.match(/(\d{1,2})\s+(January|February|March|April|May|June|July|August|September|October|November|December)\s+(\d{4})\s+\(midnight\)/i);
if(recMatch){
var mo=(MO.indexOf(recMatch[2].toLowerCase())+1).toString().padStart(2,'0');
var dy=recMatch[1].padStart(2,'0');
var recVal=recMatch[3]+'-'+mo+'-'+dy;
document.getElementById('rec').value=recVal;
found.push('Record date');
console.log('Record date:',recVal);
}

// Deadline
var dlMatch=txt.match(/(\d{1,2})\s+(January|February|March|April|May|June|July|August|September|October|November|December)\s+(\d{4})\s+at\s+(\d{1,2}):(\d{2})\s*p\.?m/i);
if(dlMatch){
var mo=(MO.indexOf(dlMatch[2].toLowerCase())+1).toString().padStart(2,'0');
var dy=dlMatch[1].padStart(2,'0');
var hr=(parseInt(dlMatch[4])+12).toString().padStart(2,'0');
var dlVal=dlMatch[3]+'-'+mo+'-'+dy+'T'+hr+':'+dlMatch[5];
document.getElementById('vote').value=dlVal;
document.getElementById('conf').value=dlVal;
found.push('Deadline');
console.log('Deadline:',dlVal);
}

// === Adresse ===
var addrMatch=txt.match(/at\s+(\d+[A-Z]?),\s+([A-Za-z\s\.]+(?:Avenue|Street|Route|Rue|Boulevard)[^,]*),\s+(L-?\d{4})/i);
if(addrMatch){
document.getElementById('bn').value=addrMatch[1];
document.getElementById('st').value=addrMatch[2].trim().toUpperCase();
document.getElementById('pc').value=addrMatch[3];
found.push('Adresse');
console.log('Adresse trouv√©e');
}

// === URL ===
var urlMatch=txt.match(/(https?:\/\/[^\s<>"]+)/i);
if(urlMatch){
document.getElementById('url').value=urlMatch[1];
found.push('URL');
console.log('URL:',urlMatch[1]);
}

// === R√©solutions ===
var resols=[];
var lines=txt.split('\n');
var inAgenda=false;
var currentNum=null;
var currentText='';

for(var i=0;i<lines.length;i++){
var line=lines[i].trim();

if(line.match(/AGENDA FOR THE ANNUAL|^I\.\s*AGENDA|AGENDA|ORDER OF BUSINESS/i)){
inAgenda=true;
console.log('Agenda start ligne',i);
continue;
}

if(!inAgenda)continue;

if(line.match(/^II\.|^PARTICIPATION|^III\.|^IV\.|^VOTING|^PROXY/i)){
console.log('Agenda end ligne',i);
break;
}

// Skip date lines
if(line.match(/^\d{1,2}\s+(January|February|March|April|May|June|July|August|September|October|November|December)\s+\d{4}/i))continue;

var resMatch=line.match(/^\s*(\d{1,2})[\.\)]\s+(.+)/);
if(resMatch){
if(currentNum&&currentText){
resols.push({n:currentNum,t:resume(currentText),f:currentText.match(/^Presentation/i)?true:false});
}
currentNum=resMatch[1];
currentText=resMatch[2];
}else if(currentNum&&line.length>5&&!line.match(/^[A-Z]{3,}$/)){
currentText+=' '+line;
}
}

if(currentNum&&currentText){
resols.push({n:currentNum,t:resume(currentText),f:currentText.match(/^Presentation/i)?true:false});
}

console.log('R√©solutions:',resols.length);

if(resols.length>0){
R=[];
C=0;
for(var i=0;i<resols.length;i++){
C++;
R.push({id:C,n:resols[i].n,t:resols[i].t,f:resols[i].f});
}
showR();
found.push(resols.length+' r√©solutions');
}

// New IDs
document.getElementById('mid').value='GMET'+Math.floor(Math.random()*1000000000);
document.getElementById('imid').value='GMET'+Math.floor(Math.random()*1000000000);

gen();

console.log('=== ANALYSE DONE ===');
console.log('Found:',found);

if(found.length>0){
msg('‚úÖ '+found.join(', '),true);
}else{
msg('‚ö†Ô∏è Aucune donn√©e extraite');
}
}

function resume(t){
t=t.trim();
if(t.match(/^Presentation of/i))return'Presentation of reports';
if(t.match(/Approval of the annual/i))return'Approval of annual accounts '+(t.match(/(\d{4})/)?t.match(/(\d{4})/)[1]:'');
if(t.match(/Approval of the consolidated/i))return'Approval of consolidated accounts '+(t.match(/(\d{4})/)?t.match(/(\d{4})/)[1]:'');
if(t.match(/Acknowledgement of the results/i))return'Acknowledgement and allocation of results';
if(t.match(/advisory vote.*remuneration/i))return t.match(/policy/i)?'Advisory vote on remuneration policy':'Advisory vote on remuneration report';
if(t.match(/discharge/i)){
var n=t.match(/to\s+([A-Z][a-z]+(?:\s+[A-Z][a-z]+)+)/);
return n?'Discharge to '+n[1]:'Granting of discharge';
}
if(t.match(/Renewal/i)){
var c=t.match(/of\s+([A-Z][A-Za-z\s\.]+S\.A\.)/);
return c?'Renewal of auditor '+c[1]:'Renewal of auditor';
}
if(t.match(/resignation/i)){
var n=t.match(/Mr\.\s+([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)/);
return n?'Resignation of '+n[1]:'Resignation';
}
if(t.match(/Appointment/i)){
var n=t.match(/Mr\.\s+([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)/);
return n?'Appointment of '+n[1]:'Appointment';
}
return t.length>100?t.substring(0,97)+'...':t;
}

function addR(){
C++;
R.push({id:C,n:C.toString(),t:'',f:false});
showR();
gen();
}

function delR(id){
if(R.length===1){alert('Minimum 1 r√©solution');return;}
R=R.filter(function(r){return r.id!==id;});
showR();
gen();
}

function updR(id,k,v){
for(var i=0;i<R.length;i++){
if(R[i].id===id){R[i][k]=v;break;}
}
gen();
}

function showR(){
var h='';
for(var i=0;i<R.length;i++){
var r=R[i];
h+='<div style="background:#fff;padding:10px;margin:8px 0;border-radius:4px;border:1px solid #ddd">';
h+='<div style="display:flex;justify-content:space-between"><b>R√©s. '+esc(r.n)+'</b>';
if(R.length>1)h+='<button onclick="delR('+r.id+')" style="background:#dc3545;color:white;border:none;padding:4px 8px;border-radius:3px;cursor:pointer">‚úï</button>';
h+='</div>';
h+='<label>N¬∞</label><input value="'+esc(r.n)+'" onchange="updR('+r.id+',\'n\',this.value)">';
h+='<label>Titre</label><textarea onchange="updR('+r.id+',\'t\',this.value)">'+esc(r.t)+'</textarea>';

h+='<label><input type="checkbox" '+(r.f?'checked':'')+' onchange="updR('+r.id+',\'f\',this.checked)"> Info seulement</label>';
h+='</div>';
}
document.getElementById('resc').innerHTML=h;
}

function esc(t){
if(!t)return'';
return String(t).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&apos;');
}

function dt(d){
return d?d+':00Z':'2026-01-01T00:00:00Z';
}

function gen(){
var x='<?xml version="1.0" encoding="UTF-8"?>\n';
x+='<Document xmlns="urn:iso:std:iso:20022:tech:xsd:seev.001.001.12">\n';
x+=' <MtgNtfctn>\n';
x+='  <NtfctnGnlInf>\n';
x+='   <NtfctnTp>NEWM</NtfctnTp>\n';
x+='   <NtfctnSts>\n';
x+='    <EvtCmpltnsSts>COMP</EvtCmpltnsSts>\n';
x+='    <EvtConfSts>CONF</EvtConfSts>\n';
x+='   </NtfctnSts>\n';
x+='  </NtfctnGnlInf>\n';
x+='  <Mtg>\n';
x+='   <MtgId>'+esc(document.getElementById('mid').value||'GMET000')+'</MtgId>\n';
x+='   <IssrMtgId>'+esc(document.getElementById('imid').value||'GMET000')+'</IssrMtgId>\n';
x+='   <Tp>GMET</Tp>\n';
x+='   <Clssfctn>\n';
x+='    <Cd>ISSU</Cd>\n';
x+='   </Clssfctn>\n';
x+='   <AnncmntDt>\n';
x+='    <DtTm>'+dt(document.getElementById('ann').value)+'</DtTm>\n';
x+='   </AnncmntDt>\n';
x+='   <Prtcptn>\n';
x+='    <PrtcptnMtd>\n';
x+='     <Cd>PHYS</Cd>\n';
x+='    </PrtcptnMtd>\n';
x+='    <IssrDdlnForVtng>\n';
x+='     <DtOrDtTm>\n';
x+='      <DtTm>'+dt(document.getElementById('vote').value)+'</DtTm>\n';
x+='     </DtOrDtTm>\n';
x+='    </IssrDdlnForVtng>\n';
x+='    <SpprtdByAcctSvcr>false</SpprtdByAcctSvcr>\n';
x+='   </Prtcptn>\n';
x+='   <Prtcptn>\n';
x+='    <PrtcptnMtd>\n';
x+='     <Cd>PRXY</Cd>\n';
x+='    </PrtcptnMtd>\n';
x+='    <IssrDdlnForVtng>\n';
x+='     <DtOrDtTm>\n';
x+='      <DtTm>'+dt(document.getElementById('vote').value)+'</DtTm>\n';
x+='     </DtOrDtTm>\n';
x+='    </IssrDdlnForVtng>\n';
x+='   </Prtcptn>\n';
x+='   <Prtcptn>\n';
x+='    <PrtcptnMtd>\n';
x+='     <Cd>EVOT</Cd>\n';
x+='    </PrtcptnMtd>\n';
x+='    <IssrDdlnForVtng>\n';
x+='     <DtOrDtTm>\n';
x+='      <DtTm>'+dt(document.getElementById('vote').value)+'</DtTm>\n';
x+='     </DtOrDtTm>\n';
x+='    </IssrDdlnForVtng>\n';
x+='   </Prtcptn>\n';
x+='   <Attndnc>\n';
x+='    <ConfInf>To attend to the meeting the shareholder need to provide : ID and proof holding of shares</ConfInf>\n';
x+='    <ConfMktDdln>\n';
x+='     <DtOrDtTm>\n';
x+='      <DtTm>'+dt(document.getElementById('conf').value)+'</DtTm>\n';
x+='     </DtOrDtTm>\n';
x+='    </ConfMktDdln>\n';
x+='   </Attndnc>\n';

var u=document.getElementById('url').value;
if(u)x+='   <AddtlDcmnttnURLAdr>'+esc(u)+'</AddtlDcmnttnURLAdr>\n';

x+='   <SctiesBlckgPrdEndDt>\n';
x+='    <DtCd>\n';
x+='     <Cd>MEET</Cd>\n';
x+='    </DtCd>\n';
x+='   </SctiesBlckgPrdEndDt>\n';
x+='   <EntitlmntFxgDt>\n';
x+='    <Dt>\n';
x+='     <Dt>'+esc(document.getElementById('rec').value||'2026-01-01')+'</Dt>\n';
x+='    </Dt>\n';
x+='    <DtMd>EODY</DtMd>\n';
x+='   </EntitlmntFxgDt>\n';
x+='  </Mtg>\n';
x+='  <MtgDtls>\n';
x+='   <DtAndTm>\n';
x+='    <DtOrDtTm>\n';
x+='     <DtTm>'+dt(document.getElementById('mtg').value)+'</DtTm>\n';
x+='    </DtOrDtTm>\n';
x+='   </DtAndTm>\n';
x+='   <Lctn>\n';
x+='    <Adr>\n';

var st=document.getElementById('st').value;
var bn=document.getElementById('bn').value;
var pc=document.getElementById('pc').value;
if(st)x+='     <StrtNm>'+esc(st)+'</StrtNm>\n';
if(bn)x+='     <BldgNb>'+esc(bn)+'</BldgNb>\n';
if(pc)x+='     <PstCd>'+esc(pc)+'</PstCd>\n';
x+='     <TwnNm>'+esc(document.getElementById('town').value||'LUXEMBOURG')+'</TwnNm>\n';
x+='     <Ctry>LU</Ctry>\n';
x+='    </Adr>\n';
x+='   </Lctn>\n';
x+='  </MtgDtls>\n';
x+='  <Issr>\n';
x+='   <Id>\n';
x+='    <NmAndAdr>\n';
x+='     <Nm>'+esc(document.getElementById('iss').value||'ISSUER')+'</Nm>\n';
x+='    </NmAndAdr>\n';
x+='   </Id>\n';
x+='  </Issr>\n';
x+='  <IssrAgt>\n';
x+='   <Id>\n';
x+='    <AnyBIC>BILLLULLXXX</AnyBIC>\n';
x+='   </Id>\n';
x+='   <Role>PRIN</Role>\n';
x+='  </IssrAgt>\n';
x+='  <Scty>\n';
x+='   <FinInstrmId>\n';
x+='    <ISIN>'+esc(document.getElementById('isin').value||'LU0000000000')+'</ISIN>\n';
x+='   </FinInstrmId>\n';
x+='   <Pos>\n';
x+='    <AcctId>099992713</AcctId>\n';
x+='    <HldgBal>\n';
x+='     <Bal>\n';
x+='      <ShrtLngPos>LONG</ShrtLngPos>\n';
x+='      <Qty>\n';
x+='       <Unit>'+esc(document.getElementById('bal').value||'0')+'.</Unit>\n';
x+='      </Qty>\n';
x+='     </Bal>\n';
x+='     <BalTp>ELIG</BalTp>\n';
x+='    </HldgBal>\n';
x+='   </Pos>\n';
x+='  </Scty>\n';

for(var i=0;i<R.length;i++){
var r=R[i];
x+='  <Rsltn>\n';
x+='   <IssrLabl>'+esc(r.n)+'</IssrLabl>\n';
x+='   <Desc>\n';
x+='    <Lang>en</Lang>\n';
x+='    <Titl>'+esc(r.t)+'</Titl>\n';
x+='   </Desc>\n';
x+='   <ForInfOnly>'+(r.f?'true':'false')+'</ForInfOnly>\n';
x+='   <Sts>ACTV</Sts>\n';
if(!r.f){
x+='   <VoteInstrTp>\n';
x+='    <VoteInstrTpCd>\n';
x+='     <Tp>CFOR</Tp>\n';
x+='    </VoteInstrTpCd>\n';
x+='   </VoteInstrTp>\n';
x+='   <VoteInstrTp>\n';
x+='    <VoteInstrTpCd>\n';
x+='     <Tp>CAGS</Tp>\n';
x+='    </VoteInstrTpCd>\n';
x+='   </VoteInstrTp>\n';
x+='   <VoteInstrTp>\n';
x+='    <VoteInstrTpCd>\n';
x+='     <Tp>ABST</Tp>\n';
x+='    </VoteInstrTpCd>\n';
x+='   </VoteInstrTp>\n';
}
x+='  </Rsltn>\n';
}

x+='  <Vote>\n';
x+='   <PrtlVoteAllwd>false</PrtlVoteAllwd>\n';
x+='   <SpltVoteAllwd>true</SpltVoteAllwd>\n';
x+='   <VoteMthds>\n';
x+='    <VoteByMail>\n';
x+='     <EmailAdr>Banque Internationale a Luxembourg</EmailAdr>\n';
x+='     <EmailAdr>69, Route d\'Esch</EmailAdr>\n';
x+='     <EmailAdr>att to Listing Agent</EmailAdr>\n';
x+='     <EmailAdr>PLM -101F</EmailAdr>\n';
x+='     <EmailAdr>L-2953 Luxembourg</EmailAdr>\n';
x+='    </VoteByMail>\n';
x+='    <VoteByTel>0035245904597</VoteByTel>\n';
x+='   </VoteMthds>\n';
x+='   <RvcbltyMktDdln>\n';
x+='    <DtOrDtTm>\n';
x+='     <DtTm>'+dt(document.getElementById('vote').value)+'</DtTm>\n';
x+='    </DtOrDtTm>\n';
x+='   </RvcbltyMktDdln>\n';
x+='   <BnfclOwnrDsclsr>true</BnfclOwnrDsclsr>\n';
x+='  </Vote>\n';
x+='  <AddtlInf>\n';
x+='   <Dsclmr>\n';
x+='    <Lang>en</Lang>\n';
x+='    <AddtlInf>CONTACT:\nemail: as_agm@bil.com\ntelefon:0035245904597</AddtlInf>\n';
x+='   </Dsclmr>\n';
x+='   <Dsclmr>\n';
x+='    <Lang>en</Lang>\n';
x+='    <AddtlInf>The vote is inside the clearings.\nThe noteholder can vote by proxy, voting form, physically during the meeting or by electronic instruction.\nThe proof of holding, the voting form, the In person attendance declaration form, the proxy form and the voting form have to be sent by email or by post to centralizing agent.\nThe proxy, the voting form, the In person attendance declaration form are available on website.\nVote Abstention is the vote by default.</AddtlInf>\n';
x+='   </Dsclmr>\n';
x+='  </AddtlInf>\n';
x+=' </MtgNtfctn>\n';
x+='</Document>';

document.getElementById('out').textContent=x;
}

function copyXml(){
var t=document.getElementById('out').textContent;
if(navigator.clipboard){
navigator.clipboard.writeText(t).then(function(){
msg('‚úÖ XML copi√©!',true);
});
}else{
var ta=document.createElement('textarea');
ta.value=t;
document.body.appendChild(ta);
ta.select();
document.execCommand('copy');
document.body.removeChild(ta);
msg('‚úÖ XML copi√©!',true);
}
}

function dlXml(){
var t=document.getElementById('out').textContent;
var blob=new Blob([t],{type:'text/xml'});
var url=URL.createObjectURL(blob);
var a=document.createElement('a');
a.href=url;
a.download='seev001_'+(document.getElementById('mid').value||'msg')+'_'+new Date().toISOString().split('T')[0]+'.xml';
a.click();
URL.revokeObjectURL(url);
}

// Lancer init au chargement
window.onload=init;
</script>

</body>
</html>