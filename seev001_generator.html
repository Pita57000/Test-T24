<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">
<title>Generateur SEEV.001</title>
<style>
body{font-family:Arial;padding:20px;background:#f0f0f0}
.container{max-width:1600px;margin:0 auto;background:white;padding:20px;border-radius:8px}
h1{color:#2a5298;text-align:center}
.paste{width:100%;min-height:100px;margin:10px 0;padding:10px;border:2px solid #667eea;border-radius:5px}
.btn{padding:10px 20px;margin:5px;border:none;border-radius:5px;cursor:pointer;font-weight:bold}
.btn-blue{background:#667eea;color:white}
.btn-green{background:#28a745;color:white}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:20px}
.form-section{padding:10px}
input,textarea{width:100%;padding:6px;margin:3px 0;border:1px solid #ddd;border-radius:3px;font-size:12px}
textarea{min-height:50px}
.xml-output{background:#2d2d2d;color:#a9dc76;padding:15px;border-radius:5px;font-family:monospace;font-size:10px;white-space:pre-wrap;min-height:400px;max-height:600px;overflow-y:auto}
.section{margin:15px 0;padding:10px;background:#f8f9fa;border-left:3px solid #667eea;border-radius:3px}
label{font-weight:bold;font-size:11px;display:block;margin-top:8px}
</style>
</head>
<body>
<div class="container">
<h1>Generateur Swift SEEV.001.001.12</h1>

<div style="background:#e8edff;padding:15px;border-radius:5px;margin:15px 0">
<strong>ETAPE 1 : Copiez-collez le texte de votre notice</strong><br>
<textarea id="paste" class="paste" placeholder="Collez le texte complet..."></textarea>
<button class="btn btn-blue" onclick="analyser()">Analyser</button>
<button class="btn btn-green" onclick="location.reload()">Reinitialiser</button>
</div>

<div id="msg" style="padding:10px;margin:10px 0;border-radius:5px"></div>

<div class="grid">
<div class="form-section">
<h3>Formulaire</h3>

<div class="section">
<strong>Meeting IDs</strong>
<label>Meeting ID</label><input id="mid" value="GMET000000000">
<label>Issuer Meeting ID</label><input id="imid" value="GMET000000000">
</div>

<div class="section">
<strong>Dates</strong>
<label>Date Annonce</label><input type="datetime-local" id="ann">
<label>Date Reunion</label><input type="datetime-local" id="mtg">
<label>Record Date</label><input type="date" id="rec">
<label>Voting Deadline</label><input type="datetime-local" id="vote">
<label>Confirmation Deadline</label><input type="datetime-local" id="conf">
</div>

<div class="section">
<strong>Emetteur et Titre</strong>
<label>Nom Emetteur</label><input id="iss">
<label>ISIN</label><input id="isin">
<label>Holding Balance</label><input id="bal">
</div>

<div class="section">
<strong>Lieu Reunion</strong>
<label>Rue</label><input id="st">
<label>Numero</label><input id="bn">
<label>Code Postal</label><input id="pc">
<label>Ville</label><input id="town" value="LUXEMBOURG">
<label>URL Documentation</label><input id="url">
</div>

<div class="section">
<strong>Resolutions</strong>
<div id="resc"></div>
<button class="btn btn-green" onclick="addR()">Ajouter</button>
</div>

</div>

<div>
<h3 style="color:#78dce8">XML Genere</h3>
<button class="btn btn-green" onclick="copy()">Copier</button>
<button class="btn btn-blue" onclick="dl()">Telecharger</button>
<pre id="out" class="xml-output"></pre>
</div>
</div>

</div>

<script>
var R=[];
var C=0;

function init(){
var n=new Date();
document.getElementById("ann").value=n.toISOString().substring(0,16);
var d30=new Date(n.getTime()+30*24*60*60*1000);
document.getElementById("mtg").value=d30.toISOString().substring(0,16);
document.getElementById("vote").value=d30.toISOString().substring(0,16);
document.getElementById("conf").value=d30.toISOString().substring(0,16);
var d14=new Date(n.getTime()+14*24*60*60*1000);
document.getElementById("rec").value=d14.toISOString().substring(0,10);
addR();
gen();
var els=document.querySelectorAll("input,textarea");
for(var i=0;i<els.length;i++){
els[i].addEventListener("input",gen);
els[i].addEventListener("change",gen);
}
}

function msg(t,ok){
var m=document.getElementById("msg");
m.innerHTML=t;
m.style.background=ok?"#d4edda":"#fff3cd";
m.style.color=ok?"#155724":"#856404";
m.style.border="1px solid "+(ok?"#28a745":"#ffc107");
setTimeout(function(){m.innerHTML=""},4000);
}

function analyser(){
var txt=document.getElementById("paste").value;
if(!txt||txt.length<100){msg("Texte trop court");return;}

msg("Analyse en cours...");
console.log("=== DEBUT ANALYSE ===");
console.log("Texte recu, longueur:",txt.length);

var isin=txt.match(/\b(LU|XS)\s?[0-9]{10}\b/i);
if(!isin)isin=txt.match(/(LU|XS)[0-9]{10}/gi);
if(isin){
var isinClean=isin[0].replace(/\s/g,"").toUpperCase();
console.log("ISIN trouve:",isinClean);
document.getElementById("isin").value=isinClean;
}

var iss=txt.match(/\*\*([A-Z][A-Za-z\s]+(?:SE|SA))\*\*/);
if(!iss)iss=txt.match(/^([A-Z][A-Za-z\s]+(?:SE|SA))\s*$/m);
if(iss){
console.log("Emetteur trouve:",iss[1]);
document.getElementById("iss").value=iss[1].trim().toUpperCase();
}

var sh=txt.match(/fourteen million[^(]+\(([0-9,]+)\)/i);
if(sh){
console.log("Shares trouves:",sh[1]);
document.getElementById("bal").value=sh[1].replace(/,/g,"");
}

var MO=["january","february","march","april","may","june","july","august","september","october","november","december"];

var mt=txt.match(/held on (\d{1,2})\s+(January|February|March|April|May|June|July|August|September|October|November|December)\s+(\d{4})\s+at\s+(\d{1,2}):(\d{2})/i);
if(mt){
var m=(MO.indexOf(mt[2].toLowerCase())+1).toString().padStart(2,"0");
var j=mt[1].padStart(2,"0");
document.getElementById("mtg").value=mt[3]+"-"+m+"-"+j+"T"+mt[4].padStart(2,"0")+":"+mt[5];
console.log("Date meeting trouvee");
}

var rc=txt.match(/(\d{1,2})\s+(January|February|March|April|May|June|July|August|September|October|November|December)\s+(\d{4})\s+\(midnight\)/i);
if(rc){
var m=(MO.indexOf(rc[2].toLowerCase())+1).toString().padStart(2,"0");
var j=rc[1].padStart(2,"0");
document.getElementById("rec").value=rc[3]+"-"+m+"-"+j;
console.log("Record date trouvee");
}

var dl=txt.match(/(\d{1,2})\s+(January|February|March|April|May|June|July|August|September|October|November|December)\s+(\d{4})\s+at\s+(\d{1,2}):(\d{2})\s+p\.m/i);
if(dl){
var m=(MO.indexOf(dl[2].toLowerCase())+1).toString().padStart(2,"0");
var j=dl[1].padStart(2,"0");
var h=(parseInt(dl[4])+12).toString().padStart(2,"0");
var v=dl[3]+"-"+m+"-"+j+"T"+h+":"+dl[5];
document.getElementById("vote").value=v;
document.getElementById("conf").value=v;
console.log("Deadline trouvee");
}

var ad=txt.match(/at\s+(\d+[A-Z]?),\s+([A-Za-z\s\.]+(?:Avenue|Street|Route)[^,]+),\s+(L-\d{4})/i);
if(ad){
document.getElementById("bn").value=ad[1];
document.getElementById("st").value=ad[2].trim().toUpperCase();
document.getElementById("pc").value=ad[3];
console.log("Adresse trouvee");
}

var u=txt.match(/(https?:\/\/[^\s<>"]+)/i);
if(u){
document.getElementById("url").value=u[1];
console.log("URL trouvee");
}

document.getElementById("mid").value="GMET"+Math.floor(Math.random()*1000000000);
document.getElementById("imid").value="GMET"+Math.floor(Math.random()*1000000000);

var resols=[];
var lines=txt.split("\n");
console.log("Nombre de lignes:",lines.length);

var inAgenda=false;
var currentNum=null;
var currentText="";

for(var i=0;i<lines.length;i++){
var line=lines[i].trim();

if(line.match(/AGENDA FOR THE ANNUAL/i)||line.match(/^I\.\s*AGENDA/i)){
inAgenda=true;
console.log("Debut AGENDA detecte ligne",i);
continue;
}

if(!inAgenda)continue;

if(line.match(/^II\.|^PARTICIPATION IN THE ANNUAL|^III\.|^IV\./i)){
console.log("Fin AGENDA detecte ligne",i);
break;
}

var isDate=line.match(/^\d{1,2}\s+(January|February|March|April|May|June|July|August|September|October|November|December)\s+\d{4}/i);
if(isDate){
console.log("Date ignoree:",line);
continue;
}

var nm=line.match(/^\s*(\d{1,2})[\.\)]\s+(.+)/);
if(nm){
if(currentNum){
resols.push({n:currentNum,t:resume(currentText),f:currentText.match(/^Presentation/i)?true:false});
console.log("Resolution ajoutee:",currentNum,resume(currentText).substring(0,50));
}
currentNum=nm[1];
currentText=nm[2];
console.log("Nouvelle resolution detectee:",currentNum);
}else if(currentNum&&line.length>5&&!line.match(/^[A-Z]{3,}/)){
currentText+=" "+line;
}
}

if(currentNum){
resols.push({n:currentNum,t:resume(currentText),f:currentText.match(/^Presentation/i)?true:false});
console.log("Derniere resolution ajoutee:",currentNum);
}

console.log("Total resolutions trouvees:",resols.length);
console.log("=== FIN ANALYSE ===");

if(resols.length>0){
R=[];
C=0;
for(var i=0;i<resols.length;i++){
C++;
R.push({id:C,n:resols[i].n,t:resols[i].t,f:resols[i].f});
}
showR();
}else{
console.warn("Aucune resolution trouvee !");
}

gen();
msg("Analyse: "+(isin?"ISIN, ":"")+resols.length+" resolutions",true);
}

function resume(t){
t=t.trim();
if(t.match(/^Presentation of/i))return"Presentation of reports";
if(t.match(/Approval of the annual/i))return"Approval of annual accounts "+(t.match(/(\d{4})/)?t.match(/(\d{4})/)[1]:"");
if(t.match(/Approval of the consolidated/i))return"Approval of consolidated accounts "+(t.match(/(\d{4})/)?t.match(/(\d{4})/)[1]:"");
if(t.match(/Acknowledgement of the results/i))return"Acknowledgement and allocation of results";
if(t.match(/advisory vote.*remuneration/i))return t.match(/policy/i)?"Advisory vote on remuneration policy":"Advisory vote on remuneration report";
if(t.match(/discharge/i)){
var n=t.match(/to\s+([A-Z][a-z]+(?:\s+[A-Z][a-z]+)+)/);
return n?"Discharge to "+n[1]:"Granting of discharge";
}
if(t.match(/Renewal/i)){
var c=t.match(/of\s+([A-Z][A-Za-z\s\.]+S\.A\.)/);
return c?"Renewal of auditor "+c[1]:"Renewal of auditor";
}
if(t.match(/resignation/i)){
var n=t.match(/Mr\.\s+([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)/);
return n?"Resignation of "+n[1]:"Resignation";
}
if(t.match(/Appointment/i)){
var n=t.match(/Mr\.\s+([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)/);
return n?"Appointment of "+n[1]:"Appointment";
}
return t.length>100?t.substring(0,97)+"...":t;
}

function addR(){
C++;
R.push({id:C,n:C.toString(),t:"",f:false});
showR();
gen();
}

function delR(id){
if(R.length===1){alert("Minimum 1 resolution");return;}
R=R.filter(function(r){return r.id!==id;});
showR();
gen();
}

function updR(id,k,v){
for(var i=0;i<R.length;i++){
if(R[i].id===id){R[i][k]=v;break;}
}
gen();
}

function showR(){
var h="";
for(var i=0;i<R.length;i++){
var r=R[i];
h+="<div style=\"background:#fff;padding:10px;margin:8px 0;border-radius:4px;border:1px solid #ddd\">";
h+="<div style=\"display:flex;justify-content:space-between\"><b>Res. "+esc(r.n)+"</b>";
if(R.length>1)h+="<button onclick=\"delR("+r.id+")\" style=\"background:#dc3545;color:white;border:none;padding:4px 8px;border-radius:3px;cursor:pointer\">X</button>";
h+="</div>";
h+="<label>No</label><input value=\""+esc(r.n)+"\" onchange=\"updR("+r.id+",'n',this.value)\">";
h+="<label>Titre</label><textarea onchange=\"updR("+r.id+",'t',this.value)\">"+esc(r.t)+"</textarea>";

h+="<label><input type=\"checkbox\" "+(r.f?"checked":"")+" onchange=\"updR("+r.id+",'f',this.checked)\"> Info seulement</label>";
h+="</div>";
}
document.getElementById("resc").innerHTML=h;
}

function esc(t){
return t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):"";
}

function dt(d){
return d?d+":00Z":"2026-01-01T00:00:00Z";
}

function gen(){
var x="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Document xmlns=\"urn:iso:std:iso:20022:tech:xsd:seev.001.001.12\">\n <MtgNtfctn>\n  <NtfctnGnlInf>\n   <NtfctnTp>NEWM</NtfctnTp>\n   <NtfctnSts>\n    <EvtCmpltnsSts>COMP</EvtCmpltnsSts>\n    <EvtConfSts>CONF</EvtConfSts>\n   </NtfctnSts>\n  </NtfctnGnlInf>\n  <Mtg>\n   <MtgId>"+esc(document.getElementById("mid").value||"GMET000")+"</MtgId>\n   <IssrMtgId>"+esc(document.getElementById("imid").value||"GMET000")+"</IssrMtgId>\n   <Tp>GMET</Tp>\n   <Clssfctn>\n    <Cd>ISSU</Cd>\n   </Clssfctn>\n   <AnncmntDt>\n    <DtTm>"+dt(document.getElementById("ann").value)+"</DtTm>\n   </AnncmntDt>\n   <Prtcptn>\n    <PrtcptnMtd>\n     <Cd>PHYS</Cd>\n    </PrtcptnMtd>\n    <IssrDdlnForVtng>\n     <DtOrDtTm>\n      <DtTm>"+dt(document.getElementById("vote").value)+"</DtTm>\n     </DtOrDtTm>\n    </IssrDdlnForVtng>\n    <SpprtdByAcctSvcr>false</SpprtdByAcctSvcr>\n   </Prtcptn>\n   <Prtcptn>\n    <PrtcptnMtd>\n     <Cd>PRXY</Cd>\n    </PrtcptnMtd>\n    <IssrDdlnForVtng>\n     <DtOrDtTm>\n      <DtTm>"+dt(document.getElementById("vote").value)+"</DtTm>\n     </DtOrDtTm>\n    </IssrDdlnForVtng>\n   </Prtcptn>\n   <Prtcptn>\n    <PrtcptnMtd>\n     <Cd>EVOT</Cd>\n    </PrtcptnMtd>\n    <IssrDdlnForVtng>\n     <DtOrDtTm>\n      <DtTm>"+dt(document.getElementById("vote").value)+"</DtTm>\n     </DtOrDtTm>\n    </IssrDdlnForVtng>\n   </Prtcptn>\n   <Attndnc>\n    <ConfInf>To attend to the meeting the shareholder need to provide : ID and proof holding of shares</ConfInf>\n    <ConfMktDdln>\n     <DtOrDtTm>\n      <DtTm>"+dt(document.getElementById("conf").value)+"</DtTm>\n     </DtOrDtTm>\n    </ConfMktDdln>\n   </Attndnc>\n";
var u=document.getElementById("url").value;
if(u)x+="   <AddtlDcmnttnURLAdr>"+esc(u)+"</AddtlDcmnttnURLAdr>\n";
x+="   <SctiesBlckgPrdEndDt>\n    <DtCd>\n     <Cd>MEET</Cd>\n    </DtCd>\n   </SctiesBlckgPrdEndDt>\n   <EntitlmntFxgDt>\n    <Dt>\n     <Dt>"+esc(document.getElementById("rec").value||"2026-01-01")+"</Dt>\n    </Dt>\n    <DtMd>EODY</DtMd>\n   </EntitlmntFxgDt>\n  </Mtg>\n  <MtgDtls>\n   <DtAndTm>\n    <DtOrDtTm>\n     <DtTm>"+dt(document.getElementById("mtg").value)+"</DtTm>\n    </DtOrDtTm>\n   </DtAndTm>\n   <Lctn>\n    <Adr>\n";
var st=document.getElementById("st").value;
var bn=document.getElementById("bn").value;
var pc=document.getElementById("pc").value;
if(st)x+="     <StrtNm>"+esc(st)+"</StrtNm>\n";
if(bn)x+="     <BldgNb>"+esc(bn)+"</BldgNb>\n";
if(pc)x+="     <PstCd>"+esc(pc)+"</PstCd>\n";
x+="     <TwnNm>"+esc(document.getElementById("town").value||"LUXEMBOURG")+"</TwnNm>\n     <Ctry>LU</Ctry>\n    </Adr>\n   </Lctn>\n  </MtgDtls>\n  <Issr>\n   <Id>\n    <NmAndAdr>\n     <Nm>"+esc(document.getElementById("iss").value||"ISSUER")+"</Nm>\n    </NmAndAdr>\n   </Id>\n  </Issr>\n  <IssrAgt>\n   <Id>\n    <AnyBIC>BILLLULLXXX</AnyBIC>\n   </Id>\n   <Role>PRIN</Role>\n  </IssrAgt>\n  <Scty>\n   <FinInstrmId>\n    <ISIN>"+esc(document.getElementById("isin").value||"LU0000000000")+"</ISIN>\n   </FinInstrmId>\n   <Pos>\n    <AcctId>099992713</AcctId>\n    <HldgBal>\n     <Bal>\n      <ShrtLngPos>LONG</ShrtLngPos>\n      <Qty>\n       <Unit>"+esc(document.getElementById("bal").value||"0")+".</Unit>\n      </Qty>\n     </Bal>\n     <BalTp>ELIG</BalTp>\n    </HldgBal>\n   </Pos>\n  </Scty>\n";
for(var i=0;i<R.length;i++){
var r=R[i];
x+=" <Rsltn>\n  <IssrLabl>"+esc(r.n)+"</IssrLabl>\n  <Desc>\n   <Lang>en</Lang>\n   <Titl>"+esc(r.t)+"</Titl>\n  </Desc>\n  <ForInfOnly>"+(r.f?"true":"false")+"</ForInfOnly>\n  <Sts>ACTV</Sts>\n";
if(!r.f){
x+="  <VoteInstrTp>\n   <VoteInstrTpCd>\n    <Tp>CFOR</Tp>\n   </VoteInstrTpCd>\n  </VoteInstrTp>\n  <VoteInstrTp>\n   <VoteInstrTpCd>\n    <Tp>CAGS</Tp>\n   </VoteInstrTpCd>\n  </VoteInstrTp>\n  <VoteInstrTp>\n   <VoteInstrTpCd>\n    <Tp>ABST</Tp>\n   </VoteInstrTpCd>\n  </VoteInstrTp>\n";
}
x+=" </Rsltn>\n";
}
x+="  <Vote>\n   <PrtlVoteAllwd>false</PrtlVoteAllwd>\n   <SpltVoteAllwd>true</SpltVoteAllwd>\n   <VoteMthds>\n    <VoteByMail>\n     <EmailAdr>Banque Internationale a Luxembourg</EmailAdr>\n     <EmailAdr>69, Route d Esch</EmailAdr>\n     <EmailAdr>att to Listing Agent</EmailAdr>\n     <EmailAdr>PLM -101F</EmailAdr>\n     <EmailAdr>L-2953 Luxembourg</EmailAdr>\n    </VoteByMail>\n    <VoteByTel>0035245904597</VoteByTel>\n   </VoteMthds>\n   <RvcbltyMktDdln>\n    <DtOrDtTm>\n     <DtTm>"+dt(document.getElementById("vote").value)+"</DtTm>\n    </DtOrDtTm>\n   </RvcbltyMktDdln>\n   <BnfclOwnrDsclsr>true</BnfclOwnrDsclsr>\n  </Vote>\n  <AddtlInf>\n   <Dsclmr>\n    <Lang>en</Lang>\n    <AddtlInf>CONTACT:\nemail: as_agm@bil.com\ntelefon:0035245904597</AddtlInf>\n   </Dsclmr>\n   <Dsclmr>\n    <Lang>en</Lang>\n    <AddtlInf>The vote is inside the clearings.\nThe noteholder can vote by proxy, voting form, physically during the meeting or by electronic instruction.\nThe proof of holding, the voting form, the In person attendance declaration form, the proxy form and the voting form have to be sent by email or by post to centralizing agent.\nThe proxy, the voting form, the In person attendance declaration form are available on website.\nVote Abstention is the vote by default.</AddtlInf>\n   </Dsclmr>\n  </AddtlInf>\n </MtgNtfctn>\n</Document>";
document.getElementById("out").textContent=x;
}

function copy(){
var t=document.getElementById("out").textContent;
var ta=document.createElement("textarea");
ta.value=t;
document.body.appendChild(ta);
ta.select();
document.execCommand("copy");
document.body.removeChild(ta);
msg("XML copie!",true);
}

function dl(){
var t=document.getElementById("out").textContent;
var blob=new Blob([t],{type:"text/xml"});
var url=URL.createObjectURL(blob);
var a=document.createElement("a");
a.href=url;
a.download="seev001_"+(document.getElementById("mid").value||"msg")+"_"+new Date().toISOString().split("T")[0]+".xml";
a.click();
}

init();
</script>

</body>
</html>