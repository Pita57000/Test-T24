<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">
<title>G√©n√©rateur SEEV.001 Standalone</title>
<style>
body{font-family:Arial;padding:20px;background:#f0f0f0}
.container{max-width:1600px;margin:0 auto;background:white;padding:20px;border-radius:8px}
h1{color:#2a5298;text-align:center}
.paste{width:100%;min-height:100px;margin:10px 0;padding:10px;border:2px solid #667eea;border-radius:5px;font-family:monospace;font-size:11px}
.btn{padding:10px 20px;margin:5px;border:none;border-radius:5px;cursor:pointer;font-weight:bold}
.btn-blue{background:#667eea;color:white}
.btn-green{background:#28a745;color:white}
.btn-red{background:#dc3545;color:white}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:20px}
.form-section{padding:10px}
input,textarea{width:100%;padding:6px;margin:3px 0;border:1px solid #ddd;border-radius:3px;font-size:12px;box-sizing:border-box}
textarea{min-height:50px;font-family:monospace}
.xml-output{background:#2d2d2d;color:#a9dc76;padding:15px;border-radius:5px;font-family:monospace;font-size:10px;white-space:pre-wrap;word-wrap:break-word;min-height:400px;max-height:600px;overflow-y:auto}
.section{margin:15px 0;padding:10px;background:#f8f9fa;border-left:3px solid #667eea;border-radius:3px}
label{font-weight:bold;font-size:11px;display:block;margin-top:8px}
.dropzone{border:3px dashed #667eea;padding:30px;margin:10px 0;border-radius:5px;text-align:center;cursor:pointer;background:#f8f9ff;transition:all 0.3s}
.dropzone:hover{background:#e8edff;border-color:#2a5298}
.dropzone.active{border-color:#28a745;background:#e8f5e9}
.msg-box{padding:10px;margin:10px 0;border-radius:5px;display:none}
.msg-box.show{display:block}
.msg-success{background:#d4edda;color:#155724;border:1px solid #28a745}
.msg-error{background:#fff3cd;color:#856404;border:1px solid #ffc107}
.msg-info{background:#d1ecf1;color:#0c5460;border:1px solid #bee5eb}
.progress-bar{width:100%;height:4px;background:#e0e0e0;border-radius:3px;margin:10px 0;overflow:hidden}
.progress-fill{height:100%;background:#28a745;width:0%;transition:width 0.3s}
.resolution-item{background:#fff;padding:10px;margin:8px 0;border-radius:4px;border:1px solid #ddd}
.scrollable{max-height:400px;overflow-y:auto;border:1px solid #ddd;border-radius:4px;padding:10px;background:#fff}
.tabs{display:flex;gap:10px;margin:10px 0}
.tab-btn{padding:8px 15px;background:#e0e0e0;border:none;border-radius:3px;cursor:pointer;font-weight:bold}
.tab-btn.active{background:#667eea;color:white}
.tab-content{display:none}
.tab-content.active{display:block}
</style>
</head>
<body>
<div class="container">
<h1>üè¶ G√©n√©rateur Swift SEEV.001.001.12 v3.0 (Standalone)</h1>

<div style="background:#e8edff;padding:15px;border-radius:5px;margin:15px 0">
<strong>üìã √âTAPE 1 : Importez votre notice</strong><br>
<div class="dropzone" id="dropzone">
<div style="font-size:2em">üìÑ</div>
<div style="font-weight:bold;color:#2a5298">Glissez-d√©posez votre fichier ici (.docx, .txt, .pdf)</div>
<div style="font-size:0.9em;color:#666;margin-top:5px">ou cliquez pour s√©lectionner</div>
<input type="file" id="fileinput" style="display:none">
</div>
<div class="progress-bar"><div class="progress-fill" id="progress"></div></div>
<div id="msg" class="msg-box"></div>

<div class="tabs">
<button class="tab-btn active" onclick="switchTab(event, 'textTab')">üìù Texte extrait</button>
<button class="tab-btn" onclick="switchTab(event, 'editTab')">‚úèÔ∏è √âditer/Coller</button>
</div>

<div id="textTab" class="tab-content active">
<textarea id="paste" class="paste" placeholder="Le texte de votre notice s'affichera ici apr√®s import..." readonly></textarea>
</div>

<div id="editTab" class="tab-content">
<strong>Collez ou √©ditez le texte ici :</strong>
<textarea id="pasteEdit" class="paste" placeholder="Collez le texte complet de votre notice..."></textarea>
<button class="btn btn-blue" onclick="copyFromEdit()">üìã Utiliser ce texte</button>
</div>

<div style="margin-top:10px">
<button class="btn btn-blue" onclick="analyser()">üîç Analyser le contenu</button>
<button class="btn btn-green" onclick="location.reload()">üîÑ R√©initialiser</button>
</div>
</div>

<div class="grid">
<div class="form-section">
<h3>üìù Formulaire</h3>

<div class="section">
<strong>Meeting IDs</strong>
<label>Meeting ID</label><input id="mid" value="GMET000000000">
<label>Issuer Meeting ID</label><input id="imid" value="GMET000000000">
</div>

<div class="section">
<strong>Dates</strong>
<label>Date Annonce</label><input type="datetime-local" id="ann">
<label>Date R√©union</label><input type="datetime-local" id="mtg">
<label>Record Date</label><input type="date" id="rec">
<label>Voting Deadline</label><input type="datetime-local" id="vote">
<label>Confirmation Deadline</label><input type="datetime-local" id="conf">
</div>

<div class="section">
<strong>√âmetteur & Titre</strong>
<label>Nom √âmetteur</label><input id="iss">
<label>ISIN</label><input id="isin" placeholder="Optionnel - √Ä compl√©ter si n√©cessaire">
<label>RCS/Num√©ro</label><input id="rcs">
<label>Holding Balance</label><input id="bal">
</div>

<div class="section">
<strong>Lieu R√©union</strong>
<label>Rue</label><input id="st">
<label>Num√©ro</label><input id="bn">
<label>Code Postal</label><input id="pc">
<label>Ville</label><input id="town" value="LUXEMBOURG">
<label>URL Documentation</label><input id="url">
</div>

<div class="section">
<strong>R√©solutions</strong>
<div id="resc" class="scrollable"></div>
<button class="btn btn-green" onclick="addR()">‚ûï Ajouter</button>
</div>

</div>

<div>
<h3 style="color:#78dce8">üìÑ XML G√©n√©r√©</h3>
<button class="btn btn-green" onclick="copy()">üìã Copier</button>
<button class="btn btn-blue" onclick="dl()">üíæ T√©l√©charger</button>
<button class="btn btn-red" onclick="clearXml()">üóëÔ∏è Effacer</button>
<pre id="out" class="xml-output"></pre>
</div>
</div>

</div>

<script>
var R = [];
var C = 0;

function switchTab(event, tabName){
document.querySelectorAll('.tab-content').forEach(el=>el.classList.remove('active'));
document.querySelectorAll('.tab-btn').forEach(el=>el.classList.remove('active'));
document.getElementById(tabName).classList.add('active');
if(event) event.target.classList.add('active');
}

function copyFromEdit(){
var txt=document.getElementById('pasteEdit').value;
if(!txt.trim()){showMsg('‚ùå Aucun texte √† copier','error');return;}
document.getElementById('paste').value=txt;
showMsg('‚úÖ Texte copi√© vers l\'onglet principal','success');
document.querySelectorAll('.tab-btn')[0].click();
}

function showMsg(t,type){
var m=document.getElementById('msg');
m.innerHTML=t;
m.className='msg-box show msg-'+type;
setTimeout(function(){m.classList.remove('show')},4000);
}

function setProgress(pct){
document.getElementById('progress').style.width=pct+'%';
}

function init(){
var n=new Date();
document.getElementById('ann').value=n.toISOString().substring(0,16);
var d30=new Date(n.getTime()+30*24*60*60*1000);
document.getElementById('mtg').value=d30.toISOString().substring(0,16);
document.getElementById('vote').value=d30.toISOString().substring(0,16);
document.getElementById('conf').value=d30.toISOString().substring(0,16);
var d14=new Date(n.getTime()+14*24*60*60*1000);
document.getElementById('rec').value=d14.toISOString().substring(0,10);

var dz=document.getElementById('dropzone');
var fi=document.getElementById('fileinput');
dz.onclick=function(){fi.click();};
fi.onchange=function(e){if(e.target.files[0])handleFile(e.target.files[0]);};
dz.ondragover=function(e){e.preventDefault();dz.classList.add('active');};
dz.ondragleave=function(){dz.classList.remove('active');};
dz.ondrop=function(e){e.preventDefault();dz.classList.remove('active');if(e.dataTransfer.files[0])handleFile(e.dataTransfer.files[0]);};

addR();
gen();
var els=document.querySelectorAll('input,textarea');
for(var i=0;i<els.length;i++){
els[i].addEventListener('input',gen);
els[i].addEventListener('change',gen);
}
}

function handleFile(file){
setProgress(10);
showMsg('‚è≥ Lecture du fichier: '+file.name,'info');
if(!file.name.match(/\.(docx|txt|pdf)$/i)){
showMsg('‚ùå Formats accept√©s: .docx, .txt, .pdf','error');
setProgress(0);
return;
}
var reader=new FileReader();
reader.onload=function(e){
setProgress(40);
var result=e.target.result;

if(file.name.endsWith('.txt')){
var txt=result;
processText(txt);
}else if(file.name.endsWith('.docx')){
extractDocx(result);
}else if(file.name.endsWith('.pdf')){
showMsg('‚ö†Ô∏è Pour les PDF, copiez-collez le texte dans l\'onglet "√âditer/Coller"','error');
setProgress(0);
}
};

if(file.name.endsWith('.docx')){
reader.readAsArrayBuffer(file);
}else{
reader.readAsText(file,'utf-8');
}
}

function processText(txt){
setProgress(70);
document.getElementById('paste').value=txt;
setProgress(90);
setTimeout(function(){setProgress(0)},500);
showMsg('‚úÖ Fichier charg√© ! V√©rifiez le contenu, puis cliquez "Analyser"','success');
}

function extractDocx(arrayBuffer){
try{
var view=new Uint8Array(arrayBuffer);
var str='';

for(var i=0;i<view.length;i++){
str+=String.fromCharCode(view[i]);
}

var xmlStart=str.indexOf('<?xml');
if(xmlStart===-1)xmlStart=str.indexOf('<w:document');
if(xmlStart===-1){
showMsg('‚ùå Format DOCX invalide - essayez copier-coller le texte','error');
setProgress(0);
return;
}

var xmlStr=str.substring(xmlStart);
var xmlEnd=xmlStr.indexOf('</w:document>');
if(xmlEnd!==-1)xmlStr=xmlStr.substring(0,xmlEnd+13);

var txt=extractTextFromXml(xmlStr);
if(txt.length<50){
showMsg('‚ùå Impossible d\'extraire le texte du DOCX - essayez copier-coller','error');
setProgress(0);
return;
}
processText(txt);
}catch(e){
console.error('Erreur DOCX:',e);
showMsg('‚ùå Erreur lecture DOCX - copiez-collez le texte dans l\'onglet "√âditer/Coller"','error');
setProgress(0);
}
}

function extractTextFromXml(xml){
var txt='';
var regex=/<w:t[^>]*>([^<]*)<\/w:t>/g;
var match;
while((match=regex.exec(xml))!==null){
txt+=match[1]+' ';
}
txt=txt.replace(/\s+/g,' ').trim();
return txt;
}

function analyser(){
var txt=document.getElementById('paste').value;
if(!txt||txt.length<100){showMsg('‚ùå Texte trop court (min 100 caract√®res)','error');return;}

showMsg('üîç Analyse en cours‚Ä¶','info');
setProgress(20);
console.log('=== D√âBUT ANALYSE ===');

var isin=null;
var isinPatterns=[
/\b(LU|XS|US|GB|DE|FR|IT|NL|BE|AT|CH|ES|SE|NO|DK|FI|IE|PT|GR|CZ|HU|PL|RO|BG|HR|SI|SK|LT|LV|EE)[A-Z0-9]{9,10}\b/gi,
/(LU|XS)[0-9]{10}/gi,
/ISIN[:\s]*([A-Z]{2}[A-Z0-9]{9,10})/gi
];

for(var p=0;p<isinPatterns.length;p++){
var matches=txt.match(isinPatterns[p]);
if(matches&&matches[0]){
isin=matches[0].replace(/\s/g,'').toUpperCase();
console.log('‚úì ISIN trouv√©:',isin);
document.getElementById('isin').value=isin;
break;
}
}
if(!isin)console.log('‚úó ISIN non trouv√© - √† compl√©ter manuellement');

setProgress(30);

var rcs=txt.match(/R\.C\.S\.\s+Luxembourg\s+([A-Z0-9]+)/i);
if(rcs){
document.getElementById('rcs').value=rcs[1];
console.log('‚úì RCS:',rcs[1]);
}

var iss=txt.match(/\*\*([A-Z][A-Za-z\s]+(?:SE|SA|S\.A\.?|S\.E\.?))\*\*/i);
if(!iss)iss=txt.match(/^([A-Z][A-Za-z\s]+(?:SE|SA|S\.A\.?|S\.E\.?))\s*$/mi);
if(iss){
var issName=iss[1].trim().toUpperCase();
document.getElementById('iss').value=issName;
console.log('‚úì √âmetteur:',issName);
}

setProgress(40);

var sh=txt.match(/([0-9,]+)\s*(?:class|share|action|shares|Class A Shares|Class C|ordinary|actions)/i);
if(!sh)sh=txt.match(/([0-9,]+)\s+class\s+[AC]\s+shares?/i);
if(!sh)sh=txt.match(/represented by.*?([0-9,]+)/i);
if(!sh)sh=txt.match(/share capital.*?([0-9,]+)/i);
if(sh){
document.getElementById('bal').value=sh[1].replace(/,/g,'');
console.log('‚úì Balance:',sh[1]);
}

var MO=['january','february','march','april','may','june','july','august','september','october','november','december'];

var mt=txt.match(/held on (\d{1,2})\s+(January|February|March|April|May|June|July|August|September|October|November|December)\s+(\d{4})\s+at\s+(\d{1,2}):(\d{2})/i);
if(!mt)mt=txt.match(/is to be held on (\d{1,2})\s+(January|February|March|April|May|June|July|August|September|October|November|December)\s+(\d{4})\s+at\s+(\d{1,2}):(\d{2})/i);
if(mt){
var m=(MO.indexOf(mt[2].toLowerCase())+1).toString().padStart(2,'0');
var j=mt[1].padStart(2,'0');
document.getElementById('mtg').value=mt[3]+'-'+m+'-'+j+'T'+mt[4].padStart(2,'0')+':'+mt[5];
console.log('‚úì Date r√©union:',mt[3]+'-'+m+'-'+j);
}

setProgress(50);

var rc=txt.match(/(\d{1,2})\s+(January|February|March|April|May|June|July|August|September|October|November|December)\s+(\d{4})\s+\(midnight\)/i);
if(rc){
var m=(MO.indexOf(rc[2].toLowerCase())+1).toString().padStart(2,'0');
var j=rc[1].padStart(2,'0');
document.getElementById('rec').value=rc[3]+'-'+m+'-'+j;
console.log('‚úì Record date:',rc[3]+'-'+m+'-'+j);
}

setProgress(60);

var dl=txt.match(/(\d{1,2})\s+(January|February|March|April|May|June|July|August|September|October|November|December)\s+(\d{4})\s+at\s+(\d{1,2}):(\d{2})\s+p\.m/i);
if(dl){
var m=(MO.indexOf(dl[2].toLowerCase())+1).toString().padStart(2,'0');
var j=dl[1].padStart(2,'0');
var h=(parseInt(dl[4])+12).toString().padStart(2,'0');
var v=dl[3]+'-'+m+'-'+j+'T'+h+':'+dl[5];
document.getElementById('vote').value=v;
document.getElementById('conf').value=v;
console.log('‚úì Deadline:',v);
}else{
var dl2=txt.match(/until (\d{1,2})\s+(January|February|March|April|May|June|July|August|September|October|November|December)\s+(\d{4})\s+at\s+(\d{1,2}):(\d{2})\s+p\.m/i);
if(dl2){
var m=(MO.indexOf(dl2[2].toLowerCase())+1).toString().padStart(2,'0');
var j=dl2[1].padStart(2,'0');
var h=(parseInt(dl2[4])+12).toString().padStart(2,'0');
var v=dl2[3]+'-'+m+'-'+j+'T'+h+':'+dl2[5];
document.getElementById('vote').value=v;
document.getElementById('conf').value=v;
console.log('‚úì Deadline (variante):',v);
}
}

setProgress(70);

var adPatterns=[
/at\s+(\d+[A-Z]?),?\s+([A-Za-z\s.\-&,]+(?:Avenue|Street|Route|Road|Rue|Boulevard|Drive|Way)),?\s+(L-\d{4})/i,
/(\d+[A-Z]?)\s+([A-Za-z\s.\-&,]+(?:Avenue|Street|Route|Road|Rue|Boulevard|Drive|Way))\s+(L-\d{4})/i,
/(?:Address|Lieu|Location)[:\s]*(\d+[A-Z]?),?\s+([A-Za-z\s.\-&,]+),?\s+(L-\d{4})/i,
/(\d+[A-Z]?)\s+([A-Za-z\s.\-&,]+)\s+(L-\d{4})\s+([A-Za-z\s]+(?:Luxembourg|Grand Duchy))/i
];

for(var a=0;a<adPatterns.length;a++){
var ad=txt.match(adPatterns[a]);
if(ad){
document.getElementById('bn').value=ad[1];
document.getElementById('st').value=ad[2].trim().replace(/,\s*$/, '').toUpperCase();
document.getElementById('pc').value=ad[3];
console.log('‚úì Adresse:',ad[1],ad[2],ad[3]);
break;
}
}

setProgress(75);

var u=txt.match(/(https?:\/\/[^\s<>""{}|\^`[\]]+)/i);
if(u){
document.getElementById('url').value=u[1];
console.log('‚úì URL:',u[1]);
}

document.getElementById('mid').value='GMET'+Math.floor(Math.random()*1000000000);
document.getElementById('imid').value='GMET'+Math.floor(Math.random()*1000000000);

setProgress(80);

var resols=[];
var lines=txt.split('\n');
var inAgenda=false;
var currentNum=null;
var currentText='';

for(var i=0;i<lines.length;i++){
var line=lines[i].trim();

if(line.match(/AGENDA FOR THE.*MEETING/i)||line.match(/^I\.\s*AGENDA/i)){
inAgenda=true;
continue;
}

if(!inAgenda)continue;

if(line.match(/^II\.|^PARTICIPATION|^III\.|^IV\.|^V\.|^VI\./i)){
inAgenda=false;
break;
}

var isDate=line.match(/^\d{1,2}\s+(January|February|March|April|May|June|July|August|September|October|November|December)\s+\d{4}/i);
if(isDate)continue;

var nm=line.match(/^\s*(\d{1,2})[.)]\s+(.+)/);
if(nm){
if(currentNum&&currentText){
var resumedText=resume(currentText);
resols.push({n:currentNum,t:resumedText,f:currentText.match(/^Presentation/i)?true:false});
}
currentNum=nm[1];
currentText=nm[2];
}else if(currentNum&&line.length>3&&!line.match(/^[A-Z]{3,}$/)){
currentText+=' '+line;
}
}

if(currentNum&&currentText){
var resumedText=resume(currentText);
resols.push({n:currentNum,t:resumedText,f:currentText.match(/^Presentation/i)?true:false});
}

console.log('‚úì R√©solutions trouv√©es:',resols.length);
console.log('=== FIN ANALYSE ===');

setProgress(90);

if(resols.length>0){
R=[];
C=0;
for(var i=0;i<resols.length;i++){
C++;
R.push({id:C,n:resols[i].n,t:resols[i].t,f:resols[i].f});
}
showR();
}

gen();
setProgress(100);
var isinMsg=isin?'‚úì ISIN trouv√©':'‚ö†Ô∏è ISIN √† completer';
showMsg('‚úÖ Analys√©: '+isinMsg+' | '+resols.length+' r√©solutions d√©tect√©es','success');
console.log('=== ANALYSE TERMIN√âE ===');
setTimeout(function(){setProgress(0)},1500);
}

function resume(t){
t=t.trim();

if(t.match(/^Presentation of/i)){
if(t.match(/auditor/i))return 'Presentation of auditor reports';
if(t.match(/consolidated/i))return 'Presentation of consolidated financial reports';
return 'Presentation of reports';
}

if(t.match(/Approval of the annual/i)){
var yearMatch=t.match(/(\d{4})/);
var year=yearMatch?yearMatch[1]:'';
if(t.match(/consolidated/i))return 'Approval of consolidated annual accounts '+year;
return 'Approval of annual accounts '+year;
}

if(t.match(/Approval of the consolidated/i)){
var yearMatch=t.match(/(\d{4})/);
var year=yearMatch?yearMatch[1]:'';
return 'Approval of consolidated financial statements '+year;
}

if(t.match(/Acknowledgement of the results/i)){
var yearMatch=t.match(/(\d{4})/);
var year=yearMatch?yearMatch[1]:'';
if(t.match(/allocation/i))return 'Acknowledgement of results and allocation of profits '+year;
return 'Acknowledgement and allocation of results';
}

if(t.match(/advisory vote.*remuneration/i)){
if(t.match(/policy/i))return 'Advisory vote on remuneration policy';
if(t.match(/report/i))return 'Advisory vote on remuneration report';
if(t.match(/board/i))return 'Advisory vote on remuneration of board members';
return 'Advisory vote on remuneration';
}

if(t.match(/discharge/i)){
var n=t.match(/Mr\.\s+([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)/i);
if(n){
var role=t.match(/member.*(?:board|supervisory)/i)?'Supervisory':'Management';
return 'Discharge of '+n[1]+' ('+role+' Board)';
}
var bn=t.match(/to\s+([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)/i);
if(bn)return 'Discharge to '+bn[1];
var role=t.match(/Supervisory/i)?'Supervisory':'Management';
return 'Discharge - '+role+' Board members';
}

if(t.match(/Renewal/i)){
if(t.match(/auditor/i)){
var c=t.match(/of\s+([A-Z][A-Za-z\s.]+)/i);
if(c)return 'Renewal of auditor mandate: '+c[1];
return 'Renewal of auditor';
}
if(t.match(/mandate/i))return 'Renewal of board mandate';
return 'Renewal';
}

if(t.match(/Appointment/i)){
var n=t.match(/Mr\.\s+([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)/i);
if(n){
var role=t.match(/supervisory/i)?'Supervisory Board':'Management Board';
return 'Appointment of '+n[1]+' to '+role;
}
return 'Appointment of board member';
}

if(t.match(/resignation/i)){
var n=t.match(/Mr\.\s+([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)/i);
if(n){
var role=t.match(/supervisory/i)?'Supervisory Board':'Management Board';
return 'Acknowledgement of resignation of '+n[1]+' from '+role;
}
return 'Acknowledgement of resignation';
}

if(t.match(/remuneration/i)){
if(t.match(/policy/i))return 'Approval of remuneration policy';
return 'Vote on remuneration';
}

var shortText=t.length>80?t.substring(0,77)+'‚Ä¶':t;
return shortText;
}

function addR(){
C++;
R.push({id:C,n:C.toString(),t:'',f:false});
showR();
gen();
}

function delR(id){
if(R.length===1){alert('Minimum 1 r√©solution');return;}
R=R.filter(function(r){return r.id!==id;});
showR();
gen();
}

function updR(id,k,v){
for(var i=0;i<R.length;i++){
if(R[i].id===id){R[i][k]=v;break;}
}
gen();
}

function showR(){
var h='';
for(var i=0;i<R.length;i++){
var r=R[i];
h+='<div class="resolution-item">';
h+='<div style="display:flex;justify-content:space-between"><b>R√©s. '+esc(r.n)+'</b>';
if(R.length>1)h+='<button onclick="delR('+r.id+')" class="btn btn-red" style="padding:4px 8px;font-size:11px;margin:0">‚úï</button>';
h+='</div>';
h+='<label>N¬∞</label><input value="'+esc(r.n)+'" onchange="updR('+r.id+',\'n\',this.value)" style="width:60px">';
h+='<label>Titre</label><textarea onchange="updR('+r.id+',\'t\',this.value)">'+esc(r.t)+'</textarea>';
h+='<label><input type="checkbox" '+(r.f?'checked':'')+' onchange="updR('+r.id+',\'f\',this.checked)"> Info seulement</label>';
h+='</div>';
}
document.getElementById('resc').innerHTML=h;
}

function esc(t){
return t?String(t).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&apos;'):'';
}

function dt(d){
return d?d+':00Z':'2026-01-01T00:00:00Z';
}

function gen(){
var x='<?xml version="1.0" encoding="UTF-8"?>\n<Document xmlns="urn:iso:std:iso:20022:tech:xsd:seev.001.001.12">\n <MtgNtfctn>\n  <NtfctnGnlInf>\n   <NtfctnTp>NEWM</NtfctnTp>\n   <NtfctnSts>\n    <EvtCmpltnsSts>COMP</EvtCmpltnsSts>\n    <EvtConfSts>CONF</EvtConfSts>\n   </NtfctnSts>\n  </NtfctnGnlInf>\n  <Mtg>\n   <MtgId>'+esc(document.getElementById('mid').value||'GMET000')+'</MtgId>\n   <IssrMtgId>'+esc(document.getElementById('imid').value||'GMET000')+'</IssrMtgId>\n   <Tp>GMET</Tp>\n   <Clssfctn>\n    <Cd>ISSU</Cd>\n   </Clssfctn>\n   <AnncmntDt>\n    <DtTm>'+dt(document.getElementById('ann').value)+'</DtTm>\n   </AnncmntDt>\n   <Prtcptn>\n    <PrtcptnMtd>\n     <Cd>PHYS</Cd>\n    </PrtcptnMtd>\n    <IssrDdlnForVtng>\n     <DtOrDtTm>\n      <DtTm>'+dt(document.getElementById('vote').value)+'</DtTm>\n     </DtOrDtTm>\n    </IssrDdlnForVtng>\n    <SpprtdByAcctSvcr>false</SpprtdByAcctSvcr>\n   </Prtcptn>\n   <Prtcptn>\n    <PrtcptnMtd>\n     <Cd>PRXY</Cd>\n    </PrtcptnMtd>\n    <IssrDdlnForVtng>\n     <DtOrDtTm>\n      <DtTm>'+dt(document.getElementById('vote').value)+'</DtTm>\n     </DtOrDtTm>\n    </IssrDdlnForVtng>\n   </Prtcptn>\n   <Prtcptn>\n    <PrtcptnMtd>\n     <Cd>EVOT</Cd>\n    </PrtcptnMtd>\n    <IssrDdlnForVtng>\n     <DtOrDtTm>\n      <DtTm>'+dt(document.getElementById('vote').value)+'</DtTm>\n     </DtOrDtTm>\n    </IssrDdlnForVtng>\n   </Prtcptn>\n   <Attndnc>\n    <ConfInf>To attend the meeting, shareholders need to provide: ID and proof of holding of shares</ConfInf>\n    <ConfMktDdln>\n     <DtOrDtTm>\n      <DtTm>'+dt(document.getElementById('conf').value)+'</DtTm>\n     </DtOrDtTm>\n    </ConfMktDdln>\n   </Attndnc>\n';
var u=document.getElementById('url').value;
if(u)x+='   <AddtlDcmnttnURLAdr>'+esc(u)+'</AddtlDcmnttnURLAdr>\n';
x+='   <SctiesBlckgPrdEndDt>\n    <DtCd>\n     <Cd>MEET</Cd>\n    </DtCd>\n   </SctiesBlckgPrdEndDt>\n   <EntitlmntFxgDt>\n    <Dt>\n     <Dt>'+(document.getElementById('rec').value||'2026-01-01')+'</Dt>\n    </Dt>\n    <DtMd>EODY</DtMd>\n   </EntitlmntFxgDt>\n  </Mtg>\n  <MtgDtls>\n   <DtAndTm>\n    <DtOrDtTm>\n     <DtTm>'+dt(document.getElementById('mtg').value)+'</DtTm>\n    </DtOrDtTm>\n   </DtAndTm>\n   <Lctn>\n    <Adr>\n';
var st=document.getElementById('st').value;
var bn=document.getElementById('bn').value;
var pc=document.getElementById('pc').value;
if(st)x+='     <StrtNm>'+esc(st)+'</StrtNm>\n';
if(bn)x+='     <BldgNb>'+esc(bn)+'</BldgNb>\n';
if(pc)x+='     <PstCd>'+esc(pc)+'</PstCd>\n';
x+='     <TwnNm>'+esc(document.getElementById('town').value||'LUXEMBOURG')+'</TwnNm>\n     <Ctry>LU</Ctry>\n    </Adr>\n   </Lctn>\n  </MtgDtls>\n  <Issr>\n   <Id>\n    <NmAndAdr>\n     <Nm>'+esc(document.getElementById('iss').value||'ISSUER')+'</Nm>\n    </NmAndAdr>\n   </Id>\n  </Issr>\n  <IssrAgt>\n   <Id>\n    <AnyBIC>BILLLULLXXX</AnyBIC>\n   </Id>\n   <Role>PRIN</Role>\n  </IssrAgt>\n  <Scty>\n   <FinInstrmId>\n    <ISIN>'+esc(document.getElementById('isin').value||'LU0000000000')+'</ISIN>\n   </FinInstrmId>\n   <Pos>\n    <AcctId>099992713</AcctId>\n    <HldgBal>\n     <Bal>\n      <ShrtLngPos>LONG</ShrtLngPos>\n      <Qty>\n       <Unit>'+esc(document.getElementById('bal').value||'0')+'</Unit>\n      </Qty>\n     </Bal>\n     <BalTp>ELIG</BalTp>\n    </HldgBal>\n   </Pos>\n  </Scty>\n';
for(var i=0;i<R.length;i++){
var r=R[i];
x+='  <Rsltn>\n   <IssrLabl>'+esc(r.n)+'</IssrLabl>\n   <Desc>\n    <Lang>en</Lang>\n    <Titl>'+esc(r.t)+'</Titl>\n   </Desc>\n   <ForInfOnly>'+(r.f?'true':'false')+'</ForInfOnly>\n   <Sts>ACTV</Sts>\n';
if(!r.f){
x+='   <VoteInstrTp>\n    <VoteInstrTpCd>\n     <Tp>CFOR</Tp>\n    </VoteInstrTpCd>\n   </VoteInstrTp>\n   <VoteInstrTp>\n    <VoteInstrTpCd>\n     <Tp>CAGS</Tp>\n    </VoteInstrTpCd>\n   </VoteInstrTp>\n   <VoteInstrTp>\n    <VoteInstrTpCd>\n     <Tp>ABST</Tp>\n    </VoteInstrTpCd>\n   </VoteInstrTp>\n';
}
x+='  </Rsltn>\n';
}
x+='  <Vote>\n   <PrtlVoteAllwd>false</PrtlVoteAllwd>\n   <SpltVoteAllwd>true</SpltVoteAllwd>\n   <VoteMthds>\n    <VoteByMail>\n     <EmailAdr>Banque Internationale a Luxembourg</EmailAdr>\n     <EmailAdr>69, Route d\'Esch</EmailAdr>\n     <EmailAdr>att to Listing Agent</EmailAdr>\n     <EmailAdr>PLM -101F</EmailAdr>\n     <EmailAdr>L-2953 Luxembourg</EmailAdr>\n    </VoteByMail>\n    <VoteByTel>0035245904597</VoteByTel>\n   </VoteMthds>\n   <RvcbltyMktDdln>\n    <DtOrDtTm>\n     <DtTm>'+dt(document.getElementById('vote').value)+'</DtTm>\n    </DtOrDtTm>\n   </RvcbltyMktDdln>\n   <BnfclOwnrDsclsr>true</BnfclOwnrDsclsr>\n  </Vote>\n  <AddtlInf>\n   <Dsclmr>\n    <Lang>en</Lang>\n    <AddtlInf>CONTACT:\nemail: as_agm@bil.com\ntelefon:0035245904597</AddtlInf>\n   </Dsclmr>\n   <Dsclmr>\n    <Lang>en</Lang>\n    <AddtlInf>The vote is inside the clearings.\nThe noteholder can vote by proxy, voting form, physically during the meeting or by electronic instruction.\nThe proof of holding, the voting form, the In person attendance declaration form, the proxy form and the voting form have to be sent by email or by post to centralizing agent.\nThe proxy, the voting form, the In person attendance declaration form are available on website.\nVote Abstention is the vote by default.</AddtlInf>\n   </Dsclmr>\n  </AddtlInf>\n </MtgNtfctn>\n</Document>';
document.getElementById('out').textContent=x;
}

function copy(){
var t=document.getElementById('out').textContent;
var ta=document.createElement('textarea');
ta.value=t;
document.body.appendChild(ta);
ta.select();
document.execCommand('copy');
document.body.removeChild(ta);
showMsg('‚úÖ XML copi√©!','success');
}

function dl(){
var t=document.getElementById('out').textContent;
var blob=new Blob([t],{type:'text/xml'});
var url=URL.createObjectURL(blob);
var a=document.createElement('a');
a.href=url;
a.download='seev001_'+(document.getElementById('mid').value||'msg')+'_'+new Date().toISOString().split('T')[0]+'.xml';
a.click();
showMsg('üì• T√©l√©charg√©!','success');
}

function clearXml(){
document.getElementById('out').textContent = '';
}

window.onload = init;
</script>
</body>
</html>
